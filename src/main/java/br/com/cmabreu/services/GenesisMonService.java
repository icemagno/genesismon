package br.com.cmabreu.services;

import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.math.BigInteger;
import java.util.ArrayList;
import java.util.List;
import java.util.Optional;

import javax.annotation.PostConstruct;

import org.apache.tomcat.util.json.JSONParser;
import org.json.JSONArray;
import org.json.JSONObject;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.messaging.simp.SimpMessagingTemplate;
import org.springframework.scheduling.annotation.EnableScheduling;
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.stereotype.Service;
import org.web3j.contracts.eip20.generated.ERC20;
import org.web3j.crypto.Credentials;
import org.web3j.protocol.Web3j;
import org.web3j.protocol.core.methods.response.TransactionReceipt;
import org.web3j.protocol.core.methods.response.Web3ClientVersion;
import org.web3j.protocol.http.HttpService;
import org.web3j.tx.gas.DefaultGasProvider;

import br.com.cmabreu.tokens.MyToken;

@Service
@EnableScheduling
public class GenesisMonService {
	private Logger logger = LoggerFactory.getLogger( GenesisMonService.class );
	private Web3j web3;
	private List<TokenInfo> tokens;
	private final String bscScanApiKey = "PRGH4EEVRARQM68YX3IA4ZVBAYTADKHHQJ";
	
	private String moonRatCode = "0x60c060405269d3c21bcecceda1000000600955600954600019816200002057fe5b0660001903600a556040518060400160405280600e81526020017f4d6f6f6e2052617420546f6b656e000000000000000000000000000000000000815250600c90805190602001906200007592919062000769565b506040518060400160405280600481526020017f4d52415400000000000000000000000000000000000000000000000000000000815250600d9080519060200190620000c392919062000769565b506009600e60006101000a81548160ff021916908360ff16021790555062093a80600f55620151806010556002601155600954601255671bc16d674ec800006013556000601560006101000a81548160ff0219169083151502179055506000601655600060175560056018556002601955601954601a556008601b55601b54601c55671bc16d674ec80000601d55620001896127106200017560016009546200060b60201b62002dc41790919060201c565b6200068160201b62002e341790919060201c565b601e553480156200019957600080fd5b506040516200685b3803806200685b8339818101604052810190620001bf919062000872565b6000620001d1620006d360201b60201c565b9050806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508073ffffffffffffffffffffffffffffffffffffffff16600073ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a350600a546003600062000286620006d360201b60201c565b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555060008190508073ffffffffffffffffffffffffffffffffffffffff1663c45a01556040518163ffffffff1660e01b815260040160206040518083038186803b1580156200031057600080fd5b505afa15801562000325573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906200034b919062000846565b73ffffffffffffffffffffffffffffffffffffffff1663c9c65396308373ffffffffffffffffffffffffffffffffffffffff1663ad5c46486040518163ffffffff1660e01b815260040160206040518083038186803b158015620003ae57600080fd5b505afa158015620003c3573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620003e9919062000846565b6040518363ffffffff1660e01b8152600401620004089291906200097a565b602060405180830381600087803b1580156200042357600080fd5b505af115801562000438573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906200045e919062000846565b73ffffffffffffffffffffffffffffffffffffffff1660a08173ffffffffffffffffffffffffffffffffffffffff1660601b815250508073ffffffffffffffffffffffffffffffffffffffff1660808173ffffffffffffffffffffffffffffffffffffffff1660601b81525050600160066000620004e1620006db60201b60201c565b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055506001600660003073ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055506200059a620006d360201b60201c565b73ffffffffffffffffffffffffffffffffffffffff16600073ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef600954604051620005fb9190620009ed565b60405180910390a3505062000b2f565b6000808314156200062057600090506200067b565b60008284029050828482816200063257fe5b041462000676576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016200066d90620009cb565b60405180910390fd5b809150505b92915050565b6000620006cb83836040518060400160405280601a81526020017f536166654d6174683a206469766973696f6e206279207a65726f0000000000008152506200070460201b60201c565b905092915050565b600033905090565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b600080831182906200074e576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401620007459190620009a7565b60405180910390fd5b5060008385816200075b57fe5b049050809150509392505050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10620007ac57805160ff1916838001178555620007dd565b82800160010185558215620007dd579182015b82811115620007dc578251825591602001919060010190620007bf565b5b509050620007ec9190620007f0565b5090565b6200081591905b8082111562000811576000816000905550600101620007f7565b5090565b90565b600081519050620008298162000afb565b92915050565b600081519050620008408162000b15565b92915050565b6000602082840312156200085957600080fd5b6000620008698482850162000818565b91505092915050565b6000602082840312156200088557600080fd5b600062000895848285016200082f565b91505092915050565b620008a98162000a78565b82525050565b620008ba8162000a26565b82525050565b6000620008cd8262000a0a565b620008d9818562000a15565b9350620008eb81856020860162000ab4565b620008f68162000aea565b840191505092915050565b60006200091060218362000a15565b91507f536166654d6174683a206d756c7469706c69636174696f6e206f766572666c6f60008301527f77000000000000000000000000000000000000000000000000000000000000006020830152604082019050919050565b620009748162000a6e565b82525050565b60006040820190506200099160008301856200089e565b620009a06020830184620008af565b9392505050565b60006020820190508181036000830152620009c38184620008c0565b905092915050565b60006020820190508181036000830152620009e68162000901565b9050919050565b600060208201905062000a04600083018462000969565b92915050565b600081519050919050565b600082825260208201905092915050565b600062000a338262000a4e565b9050919050565b600062000a478262000a4e565b9050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b600062000a858262000a8c565b9050919050565b600062000a998262000aa0565b9050919050565b600062000aad8262000a4e565b9050919050565b60005b8381101562000ad457808201518184015260208101905062000ab7565b8381111562000ae4576000848401525b50505050565b6000601f19601f8301169050919050565b62000b068162000a26565b811462000b1257600080fd5b50565b62000b208162000a3a565b811462000b2c57600080fd5b50565b60805160601c60a05160601c615cdf62000b7c600039806126c952806135cc5280613672525080611b1852806121a1528061265e52806126ed528061375d52806138155250615cdf6000f3fe6080604052600436106103035760003560e01c8063715018a611610190578063a9059cbb116100dc578063c49b9a8011610095578063dd62ed3e1161006f578063dd62ed3e14610b86578063ea2f0b3714610bc3578063f2fde38b14610bec578063fda48a7314610c155761030a565b8063c49b9a8014610b0b578063d543dbeb14610b34578063dd46706414610b5d5761030a565b8063a9059cbb146109f9578063b2644c0714610a36578063b47fd56314610a4d578063b6c5232414610a8a578063b8c9d25c14610ab5578063c21ebd0714610ae05761030a565b80638fda356d1161014957806395d89b411161012357806395d89b411461094f5780639bb4dc601461097a578063a457c2d7146109a5578063a69df4b5146109e25761030a565b80638fda356d146108e25780638feed79a146108f957806395ba68d7146109245761030a565b8063715018a6146107e45780637217f4bc146107fb5780637d1db4a51461082657806388f82020146108515780638da5cb5b1461088e5780638ee88c53146108b95761030a565b80633bd5d1731161024f5780635342acb4116102085780636a40701c116101e25780636a40701c1461073a5780636bc87c3a146107515780636d33a4681461077c57806370a08231146107a75761030a565b80635342acb4146106a75780635e4196ab146106e45780635ea4d29c1461070f5761030a565b80633bd5d173146105945780633d87ea75146105bd578063437823ec146105ed5780634549b039146106165780634a74bb021461065357806352390c021461067e5761030a565b806323b872dd116102bc5780633685d419116102965780633685d419146104d857806337ad7cf514610501578063395093511461052c5780633b124fe7146105695761030a565b806323b872dd146104335780632d83811914610470578063313ce567146104ad5761030a565b8063061c82d01461030f57806306fdde0314610338578063095ea7b31461036357806313114a9d146103a057806318160ddd146103cb5780632060995e146103f65761030a565b3661030a57005b600080fd5b34801561031b57600080fd5b5061033660048036038101906103319190614e1f565b610c40565b005b34801561034457600080fd5b5061034d610ce0565b60405161035a9190615768565b60405180910390f35b34801561036f57600080fd5b5061038a60048036038101906103859190614dba565b610d82565b6040516103979190615732565b60405180910390f35b3480156103ac57600080fd5b506103b5610da0565b6040516103c291906159ea565b60405180910390f35b3480156103d757600080fd5b506103e0610daa565b6040516103ed91906159ea565b60405180910390f35b34801561040257600080fd5b5061041d60048036038101906104189190614d06565b610db4565b60405161042a91906159ea565b60405180910390f35b34801561043f57600080fd5b5061045a60048036038101906104559190614d6b565b610e98565b6040516104679190615732565b60405180910390f35b34801561047c57600080fd5b5061049760048036038101906104929190614e1f565b610f73565b6040516104a491906159ea565b60405180910390f35b3480156104b957600080fd5b506104c2610fe1565b6040516104cf9190615ae2565b60405180910390f35b3480156104e457600080fd5b506104ff60048036038101906104fa9190614d06565b610ff8565b005b34801561050d57600080fd5b50610516611320565b60405161052391906159ea565b60405180910390f35b34801561053857600080fd5b50610553600480360381019061054e9190614dba565b611326565b6040516105609190615732565b60405180910390f35b34801561057557600080fd5b5061057e6113d9565b60405161058b91906159ea565b60405180910390f35b3480156105a057600080fd5b506105bb60048036038101906105b69190614e1f565b6113df565b005b6105d760048036038101906105d29190614dba565b61155a565b6040516105e49190615732565b60405180910390f35b3480156105f957600080fd5b50610614600480360381019061060f9190614d06565b611579565b005b34801561062257600080fd5b5061063d60048036038101906106389190614e71565b61166a565b60405161064a91906159ea565b60405180910390f35b34801561065f57600080fd5b506106686116ee565b6040516106759190615732565b60405180910390f35b34801561068a57600080fd5b506106a560048036038101906106a09190614d06565b611701565b005b3480156106b357600080fd5b506106ce60048036038101906106c99190614d06565b6119b6565b6040516106db9190615732565b60405180910390f35b3480156106f057600080fd5b506106f9611a0c565b60405161070691906159ea565b60405180910390f35b34801561071b57600080fd5b50610724611a12565b60405161073191906159ea565b60405180910390f35b34801561074657600080fd5b5061074f611a18565b005b34801561075d57600080fd5b50610766611d3c565b60405161077391906159ea565b60405180910390f35b34801561078857600080fd5b50610791611d42565b60405161079e91906159ea565b60405180910390f35b3480156107b357600080fd5b506107ce60048036038101906107c99190614d06565b611d48565b6040516107db91906159ea565b60405180910390f35b3480156107f057600080fd5b506107f9611e33565b005b34801561080757600080fd5b50610810611f88565b60405161081d91906159ea565b60405180910390f35b34801561083257600080fd5b5061083b611f8e565b60405161084891906159ea565b60405180910390f35b34801561085d57600080fd5b5061087860048036038101906108739190614d06565b611f94565b6040516108859190615732565b60405180910390f35b34801561089a57600080fd5b506108a3611fea565b6040516108b0919061563b565b60405180910390f35b3480156108c557600080fd5b506108e060048036038101906108db9190614e1f565b612013565b005b3480156108ee57600080fd5b506108f76120b3565b005b34801561090557600080fd5b5061090e6121e8565b60405161091b91906159ea565b60405180910390f35b34801561093057600080fd5b506109396121ee565b60405161094691906159ea565b60405180910390f35b34801561095b57600080fd5b506109646121f4565b6040516109719190615768565b60405180910390f35b34801561098657600080fd5b5061098f612296565b60405161099c91906159ea565b60405180910390f35b3480156109b157600080fd5b506109cc60048036038101906109c79190614dba565b6122b4565b6040516109d99190615732565b60405180910390f35b3480156109ee57600080fd5b506109f7612381565b005b348015610a0557600080fd5b50610a206004803603810190610a1b9190614dba565b612556565b604051610a2d9190615732565b60405180910390f35b348015610a4257600080fd5b50610a4b612576565b005b348015610a5957600080fd5b50610a746004803603810190610a6f9190614d06565b6126a5565b604051610a8191906159ea565b60405180910390f35b348015610a9657600080fd5b50610a9f6126bd565b604051610aac91906159ea565b60405180910390f35b348015610ac157600080fd5b50610aca6126c7565b604051610ad7919061563b565b60405180910390f35b348015610aec57600080fd5b50610af56126eb565b604051610b02919061574d565b60405180910390f35b348015610b1757600080fd5b50610b326004803603810190610b2d9190614df6565b61270f565b005b348015610b4057600080fd5b50610b5b6004803603810190610b569190614e1f565b6127f9565b005b348015610b6957600080fd5b50610b846004803603810190610b7f9190614e1f565b6128c1565b005b348015610b9257600080fd5b50610bad6004803603810190610ba89190614d2f565b612a82565b604051610bba91906159ea565b60405180910390f35b348015610bcf57600080fd5b50610bea6004803603810190610be59190614d06565b612b09565b005b348015610bf857600080fd5b50610c136004803603810190610c0e9190614d06565b612bfa565b005b348015610c2157600080fd5b50610c2a612dbe565b604051610c3791906159ea565b60405180910390f35b610c48612e7e565b73ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614610cd6576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610ccd906158ea565b60405180910390fd5b8060198190555050565b6060600c8054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610d785780601f10610d4d57610100808354040283529160200191610d78565b820191906000526020600020905b815481529060010190602001808311610d5b57829003601f168201915b5050505050905090565b6000610d96610d8f612e7e565b8484612e86565b6001905092915050565b6000600b54905090565b6000600954905090565b600080610df1610dc561dead611d48565b610de3610dd26000611d48565b60095461305190919063ffffffff16565b61305190919063ffffffff16565b9050736559cdd71239e2dc776388f55f10ed464e7559ab63163296bc600954610e1986611d48565b4760185486896040518763ffffffff1660e01b8152600401610e4096959493929190615a81565b60206040518083038186803b158015610e5857600080fd5b505af4158015610e6c573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610e909190614e48565b915050919050565b6000610ea7848484600061309b565b610f6884610eb3612e7e565b610f6385604051806060016040528060288152602001615c5d60289139600560008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000610f19612e7e565b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020546132989092919063ffffffff16565b612e86565b600190509392505050565b6000600a54821115610fba576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610fb1906157ea565b60405180910390fd5b6000610fc46132f3565b9050610fd98184612e3490919063ffffffff16565b915050919050565b6000600e60009054906101000a900460ff16905090565b611000612e7e565b73ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461108e576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611085906158ea565b60405180910390fd5b600760008273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff1661111a576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016111119061584a565b60405180910390fd5b60008090505b60088054905081101561131c578173ffffffffffffffffffffffffffffffffffffffff166008828154811061115157fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141561130f576008600160088054905003815481106111ad57fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600882815481106111e557fe5b9060005260206000200160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506000600460008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055506000600760008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff02191690831515021790555060088054806112d557fe5b6001900381819060005260206000200160006101000a81549073ffffffffffffffffffffffffffffffffffffffff0219169055905561131c565b8080600101915050611120565b5050565b60105481565b60006113cf611333612e7e565b846113ca8560056000611344612e7e565b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008973ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205461331e90919063ffffffff16565b612e86565b6001905092915050565b60195481565b60006113e9612e7e565b9050600760008273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff1615611478576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161146f9061598a565b60405180910390fd5b600061148383613373565b505050505090506114dc81600360008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205461305190919063ffffffff16565b600360008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555061153481600a5461305190919063ffffffff16565b600a8190555061154f83600b5461331e90919063ffffffff16565b600b81905550505050565b600061156f611567612e7e565b84843461309b565b6001905092915050565b611581612e7e565b73ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461160f576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611606906158ea565b60405180910390fd5b6001600660008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff02191690831515021790555050565b60006009548311156116b1576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016116a89061586a565b60405180910390fd5b816116d15760006116c184613373565b50505050509050809150506116e8565b60006116dc84613373565b50505050915050809150505b92915050565b601560009054906101000a900460ff1681565b611709612e7e565b73ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614611797576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161178e906158ea565b60405180910390fd5b600760008273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff1615611824576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161181b9061584a565b60405180910390fd5b6000600360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205411156118f8576118b4600360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054610f73565b600460008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055505b6001600760008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055506008819080600181540180825580915050600190039060005260206000200160009091909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b6000600660008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff169050919050565b60165481565b601d5481565b42601460003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020541115611a9a576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611a919061578a565b60405180910390fd5b6000611aa533611d48565b1015611ae6576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611add906158aa565b60405180910390fd5b6000611af133610db4565b9050601d548110611bc557736559cdd71239e2dc776388f55f10ed464e7559ab63c549d3ae7f000000000000000000000000000000000000000000000000000000000000000061dead611b4e600586612e3490919063ffffffff16565b6040518463ffffffff1660e01b8152600401611b6c9392919061568d565b60006040518083038186803b158015611b8457600080fd5b505af4158015611b98573d6000803e3d6000fd5b50505050611bc2611bb3600583612e3490919063ffffffff16565b8261305190919063ffffffff16565b90505b60003373ffffffffffffffffffffffffffffffffffffffff1682604051611beb90615626565b60006040518083038185875af1925050503d8060008114611c28576040519150601f19603f3d011682016040523d82523d6000602084013e611c2d565b606091505b5050905080611c71576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611c689061594a565b60405180910390fd5b611c79612296565b4201601460003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055507f76a3a606d310d32750e15a3d246d186b789084096189d51661559b0f97f3bec93383601460003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054604051611d3093929190615656565b60405180910390a15050565b601b5481565b60135481565b6000600760008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff1615611de357600460008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549050611e2e565b611e2b600360008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054610f73565b90505b919050565b611e3b612e7e565b73ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614611ec9576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611ec0906158ea565b60405180910390fd5b600073ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a360008060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550565b600f5481565b60125481565b6000600760008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff169050919050565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b61201b612e7e565b73ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16146120a9576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016120a0906158ea565b60405180910390fd5b80601b8190555050565b6120bb612e7e565b73ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614612149576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401612140906158ea565b60405180910390fd5b62093a80420160178190555062093a80600f81905550620151806010819055506005601881905550671bc16d674ec800006013819055504260168190555061219160056127f9565b61219b600161270f565b6121e6307f00000000000000000000000000000000000000000000000000000000000000007fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff612e86565b565b60185481565b60175481565b6060600d8054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561228c5780601f106122615761010080835404028352916020019161228c565b820191906000526020600020905b81548152906001019060200180831161226f57829003601f168201915b5050505050905090565b600060175442106122ab57600f5490506122b1565b60105490505b90565b60006123776122c1612e7e565b8461237285604051806060016040528060258152602001615c8560259139600560006122eb612e7e565b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020546132989092919063ffffffff16565b612e86565b6001905092915050565b3373ffffffffffffffffffffffffffffffffffffffff16600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614612411576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401612408906159ca565b60405180910390fd5b6002544211612455576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161244c9061596a565b60405180910390fd5b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a3600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550565b600061256c612563612e7e565b8484600061309b565b6001905092915050565b61257e612e7e565b73ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461260c576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401612603906158ea565b60405180910390fd5b42601781905550610708600f81905550620151806010819055506005601881905550671bc16d674ec800006013819055504260168190555061264e60056127f9565b612658600161270f565b6126a3307f00000000000000000000000000000000000000000000000000000000000000007fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff612e86565b565b60146020528060005260406000206000915090505481565b6000600254905090565b7f000000000000000000000000000000000000000000000000000000000000000081565b7f000000000000000000000000000000000000000000000000000000000000000081565b612717612e7e565b73ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16146127a5576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161279c906158ea565b60405180910390fd5b80601560006101000a81548160ff0219169083151502179055507f53726dfcaf90650aa7eb35524f4d3220f07413c8d6cb404cc8c18bf5591bc159816040516127ee9190615732565b60405180910390a150565b612801612e7e565b73ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461288f576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401612886906158ea565b60405180910390fd5b6128b86127106128aa83600954612dc490919063ffffffff16565b612e3490919063ffffffff16565b60128190555050565b6128c9612e7e565b73ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614612957576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161294e906158ea565b60405180910390fd5b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060008060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550804201600281905550600073ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a350565b6000600560008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054905092915050565b612b11612e7e565b73ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614612b9f576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401612b96906158ea565b60405180910390fd5b6000600660008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff02191690831515021790555050565b612c02612e7e565b73ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614612c90576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401612c87906158ea565b60405180910390fd5b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff161415612d00576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401612cf79061580a565b60405180910390fd5b8073ffffffffffffffffffffffffffffffffffffffff166000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a3806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b60115481565b600080831415612dd75760009050612e2e565b6000828402905082848281612de857fe5b0414612e29576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401612e20906158ca565b60405180910390fd5b809150505b92915050565b6000612e7683836040518060400160405280601a81526020017f536166654d6174683a206469766973696f6e206279207a65726f0000000000008152506133cf565b905092915050565b600033905090565b600073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff161415612ef6576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401612eed906157ca565b60405180910390fd5b600073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff161415612f66576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401612f5d906159aa565b60405180910390fd5b80600560008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055508173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b9258360405161304491906159ea565b60405180910390a3505050565b600061309383836040518060400160405280601e81526020017f536166654d6174683a207375627472616374696f6e206f766572666c6f770000815250613298565b905092915050565b600073ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff16141561310b576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401613102906157aa565b60405180910390fd5b600073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff16141561317b576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016131729061592a565b60405180910390fd5b600082116131be576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016131b59061590a565b60405180910390fd5b6131ca84848484613430565b6131d48484613583565b600060019050600660008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff168061327b5750600660008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff165b1561328557600090505b613291858585846138d6565b5050505050565b60008383111582906132e0576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016132d79190615768565b60405180910390fd5b5060008385039050809150509392505050565b6000806000613300613bf1565b915091506133178183612e3490919063ffffffff16565b9250505090565b600080828401905083811015613369576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016133609061582a565b60405180910390fd5b8091505092915050565b600080600080600080600080600061338a8a613e85565b92509250925060008060006133a88d86866133a36132f3565b613edf565b9250925092508282828888889b509b509b509b509b509b5050505050505091939550919395565b60008083118290613416576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161340d9190615768565b60405180910390fd5b50600083858161342257fe5b049050809150509392505050565b613438611fea565b73ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff16141580156134a65750613476611fea565b73ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1614155b80156134df5750600073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1614155b8015613519575061dead73ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1614155b1561357d576013548110801561353157506016544210155b1561357c5760125482111561357b576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016135729061588a565b60405180910390fd5b5b5b50505050565b600061358e30611d48565b9050601254811061359f5760125490505b6000601e548210159050600e60019054906101000a900460ff161580156135c35750805b801561361b57507f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff1614155b80156136335750601560009054906101000a900460ff165b80156136c257503073ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff161480156136c057507f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff16145b155b156138d057601e54915060006136e2600284612e3490919063ffffffff16565b9050600061370c60026136fe848761305190919063ffffffff16565b612e3490919063ffffffff16565b90506000613723828661305190919063ffffffff16565b9050600061373a838561331e90919063ffffffff16565b90506000479050736559cdd71239e2dc776388f55f10ed464e7559ab6356feb11b7f0000000000000000000000000000000000000000000000000000000000000000846040518363ffffffff1660e01b815260040161379a929190615709565b60006040518083038186803b1580156137b257600080fd5b505af41580156137c6573d6000803e3d6000fd5b5050505060006137df824761305190919063ffffffff16565b905060006137f7600383612e3490919063ffffffff16565b9050736559cdd71239e2dc776388f55f10ed464e7559ab63cf6c62ea7f000000000000000000000000000000000000000000000000000000000000000061383c611fea565b88856040518563ffffffff1660e01b815260040161385d94939291906156c4565b60006040518083038186803b15801561387557600080fd5b505af4158015613889573d6000803e3d6000fd5b505050507f17bbfb9a6069321b6ded73bd96327c9e6b7212a5cd51ff219cd61370acafb5618683876040516138c093929190615a05565b60405180910390a1505050505050505b50505050565b806138e4576138e3613f68565b5b6138ee8383613fab565b600760008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff1680156139915750600760008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16155b156139a6576139a18484846140dd565b613bdd565b600760008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16158015613a495750600760008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff165b15613a5e57613a5984848461433d565b613bdc565b600760008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16158015613b025750600760008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16155b15613b1757613b1284848461459d565b613bdb565b600760008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff168015613bb95750600760008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff165b15613bce57613bc9848484614768565b613bda565b613bd984848461459d565b5b5b5b5b80613beb57613bea614a5d565b5b50505050565b6000806000600a5490506000600954905060008090505b600880549050811015613e4857826003600060088481548110613c2757fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020541180613d0e5750816004600060088481548110613ca657fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054115b15613d2557600a5460095494509450505050613e81565b613dae6003600060088481548110613d3957fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020548461305190919063ffffffff16565b9250613e396004600060088481548110613dc457fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020548361305190919063ffffffff16565b91508080600101915050613c08565b50613e60600954600a54612e3490919063ffffffff16565b821015613e7857600a54600954935093505050613e81565b81819350935050505b9091565b600080600080613e9485614a71565b90506000613ea186614aa2565b90506000613eca82613ebc858a61305190919063ffffffff16565b61305190919063ffffffff16565b90508083839550955095505050509193909250565b600080600080613ef88589612dc490919063ffffffff16565b90506000613f0f8689612dc490919063ffffffff16565b90506000613f268789612dc490919063ffffffff16565b90506000613f4f82613f41858761305190919063ffffffff16565b61305190919063ffffffff16565b9050838184965096509650505050509450945094915050565b6000601954148015613f7c57506000601b54145b15613f8657613fa9565b601954601a81905550601b54601c8190555060006019819055506000601b819055505b565b6000613fb683611d48565b90506000613fc2612296565b9050736559cdd71239e2dc776388f55f10ed464e7559ab638958b5a98383601154876040518563ffffffff1660e01b81526004016140039493929190615a3c565b60206040518083038186803b15801561401b57600080fd5b505af415801561402f573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906140539190614e48565b601460008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205401601460008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555050505050565b6000806000806000806140ef87613373565b95509550955095509550955061414d87600460008c73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205461305190919063ffffffff16565b600460008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055506141e286600360008c73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205461305190919063ffffffff16565b600360008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555061427785600360008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205461331e90919063ffffffff16565b600360008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055506142c381614ad3565b6142cd8483614c78565b8773ffffffffffffffffffffffffffffffffffffffff168973ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef8560405161432a91906159ea565b60405180910390a3505050505050505050565b60008060008060008061434f87613373565b9550955095509550955095506143ad86600360008c73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205461305190919063ffffffff16565b600360008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555061444283600460008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205461331e90919063ffffffff16565b600460008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055506144d785600360008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205461331e90919063ffffffff16565b600360008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555061452381614ad3565b61452d8483614c78565b8773ffffffffffffffffffffffffffffffffffffffff168973ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef8560405161458a91906159ea565b60405180910390a3505050505050505050565b6000806000806000806145af87613373565b95509550955095509550955061460d86600360008c73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205461305190919063ffffffff16565b600360008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055506146a285600360008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205461331e90919063ffffffff16565b600360008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055506146ee81614ad3565b6146f88483614c78565b8773ffffffffffffffffffffffffffffffffffffffff168973ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef8560405161475591906159ea565b60405180910390a3505050505050505050565b60008060008060008061477a87613373565b9550955095509550955095506147d887600460008c73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205461305190919063ffffffff16565b600460008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555061486d86600360008c73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205461305190919063ffffffff16565b600360008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555061490283600460008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205461331e90919063ffffffff16565b600460008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555061499785600360008b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205461331e90919063ffffffff16565b600360008a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055506149e381614ad3565b6149ed8483614c78565b8773ffffffffffffffffffffffffffffffffffffffff168973ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef85604051614a4a91906159ea565b60405180910390a3505050505050505050565b601a54601981905550601c54601b81905550565b6000614a9b6064614a8d60195485612dc490919063ffffffff16565b612e3490919063ffffffff16565b9050919050565b6000614acc6064614abe601b5485612dc490919063ffffffff16565b612e3490919063ffffffff16565b9050919050565b6000614add6132f3565b90506000614af48284612dc490919063ffffffff16565b9050614b4881600360003073ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205461331e90919063ffffffff16565b600360003073ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081905550600760003073ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff1615614c7357614c2f83600460003073ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205461331e90919063ffffffff16565b600460003073ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055505b505050565b614c8d82600a5461305190919063ffffffff16565b600a81905550614ca881600b5461331e90919063ffffffff16565b600b819055505050565b600081359050614cc181615c17565b92915050565b600081359050614cd681615c2e565b92915050565b600081359050614ceb81615c45565b92915050565b600081519050614d0081615c45565b92915050565b600060208284031215614d1857600080fd5b6000614d2684828501614cb2565b91505092915050565b60008060408385031215614d4257600080fd5b6000614d5085828601614cb2565b9250506020614d6185828601614cb2565b9150509250929050565b600080600060608486031215614d8057600080fd5b6000614d8e86828701614cb2565b9350506020614d9f86828701614cb2565b9250506040614db086828701614cdc565b9150509250925092565b60008060408385031215614dcd57600080fd5b6000614ddb85828601614cb2565b9250506020614dec85828601614cdc565b9150509250929050565b600060208284031215614e0857600080fd5b6000614e1684828501614cc7565b91505092915050565b600060208284031215614e3157600080fd5b6000614e3f84828501614cdc565b91505092915050565b600060208284031215614e5a57600080fd5b6000614e6884828501614cf1565b91505092915050565b60008060408385031215614e8457600080fd5b6000614e9285828601614cdc565b9250506020614ea385828601614cc7565b9150509250929050565b614eb681615b79565b82525050565b614ec581615b24565b82525050565b614ed481615b24565b82525050565b614ee381615b36565b82525050565b614ef281615b8b565b82525050565b6000614f0382615afd565b614f0d8185615b13565b9350614f1d818560208601615bd3565b614f2681615c06565b840191505092915050565b6000614f3e602183615b13565b91507f4572726f723a206e65787420617661696c61626c65206e6f742072656163686560008301527f64000000000000000000000000000000000000000000000000000000000000006020830152604082019050919050565b6000614fa4602583615b13565b91507f42455032303a207472616e736665722066726f6d20746865207a65726f20616460008301527f64726573730000000000000000000000000000000000000000000000000000006020830152604082019050919050565b600061500a602483615b13565b91507f42455032303a20617070726f76652066726f6d20746865207a65726f2061646460008301527f72657373000000000000000000000000000000000000000000000000000000006020830152604082019050919050565b6000615070602a83615b13565b91507f416d6f756e74206d757374206265206c657373207468616e20746f74616c207260008301527f65666c656374696f6e73000000000000000000000000000000000000000000006020830152604082019050919050565b60006150d6602683615b13565b91507f4f776e61626c653a206e6577206f776e657220697320746865207a65726f206160008301527f64647265737300000000000000000000000000000000000000000000000000006020830152604082019050919050565b600061513c601b83615b13565b91507f536166654d6174683a206164646974696f6e206f766572666c6f7700000000006000830152602082019050919050565b600061517c601b83615b13565b91507f4163636f756e7420697320616c7265616479206578636c7564656400000000006000830152602082019050919050565b60006151bc601f83615b13565b91507f416d6f756e74206d757374206265206c657373207468616e20737570706c79006000830152602082019050919050565b60006151fc602883615b13565b91507f5472616e7366657220616d6f756e74206578636565647320746865206d61785460008301527f78416d6f756e742e0000000000000000000000000000000000000000000000006020830152604082019050919050565b6000615262602483615b13565b91507f4572726f723a206d757374206f776e204d52415420746f20636c61696d20726560008301527f77617264000000000000000000000000000000000000000000000000000000006020830152604082019050919050565b60006152c8602183615b13565b91507f536166654d6174683a206d756c7469706c69636174696f6e206f766572666c6f60008301527f77000000000000000000000000000000000000000000000000000000000000006020830152604082019050919050565b600061532e602083615b13565b91507f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e65726000830152602082019050919050565b600061536e602983615b13565b91507f5472616e7366657220616d6f756e74206d75737420626520677265617465722060008301527f7468616e207a65726f00000000000000000000000000000000000000000000006020830152604082019050919050565b60006153d4602383615b13565b91507f42455032303a207472616e7366657220746f20746865207a65726f206164647260008301527f65737300000000000000000000000000000000000000000000000000000000006020830152604082019050919050565b600061543a600083615b08565b9150600082019050919050565b6000615454601d83615b13565b91507f4572726f723a2043616e6e6f74207769746864726177207265776172640000006000830152602082019050919050565b6000615494601f83615b13565b91507f436f6e7472616374206973206c6f636b656420756e74696c20372064617973006000830152602082019050919050565b60006154d4602c83615b13565b91507f4578636c75646564206164647265737365732063616e6e6f742063616c6c207460008301527f6869732066756e6374696f6e00000000000000000000000000000000000000006020830152604082019050919050565b600061553a602283615b13565b91507f42455032303a20617070726f766520746f20746865207a65726f20616464726560008301527f73730000000000000000000000000000000000000000000000000000000000006020830152604082019050919050565b60006155a0602383615b13565b91507f596f7520646f6e27742068617665207065726d697373696f6e20746f20756e6c60008301527f6f636b00000000000000000000000000000000000000000000000000000000006020830152604082019050919050565b61560281615b62565b82525050565b61561181615b62565b82525050565b61562081615b6c565b82525050565b60006156318261542d565b9150819050919050565b60006020820190506156506000830184614ebc565b92915050565b600060608201905061566b6000830186614ead565b61567860208301856155f9565b61568560408301846155f9565b949350505050565b60006060820190506156a26000830186614ecb565b6156af6020830185614ecb565b6156bc6040830184615608565b949350505050565b60006080820190506156d96000830187614ecb565b6156e66020830186614ecb565b6156f36040830185615608565b6157006060830184615608565b95945050505050565b600060408201905061571e6000830185614ecb565b61572b6020830184615608565b9392505050565b60006020820190506157476000830184614eda565b92915050565b60006020820190506157626000830184614ee9565b92915050565b600060208201905081810360008301526157828184614ef8565b905092915050565b600060208201905081810360008301526157a381614f31565b9050919050565b600060208201905081810360008301526157c381614f97565b9050919050565b600060208201905081810360008301526157e381614ffd565b9050919050565b6000602082019050818103600083015261580381615063565b9050919050565b60006020820190508181036000830152615823816150c9565b9050919050565b600060208201905081810360008301526158438161512f565b9050919050565b600060208201905081810360008301526158638161516f565b9050919050565b60006020820190508181036000830152615883816151af565b9050919050565b600060208201905081810360008301526158a3816151ef565b9050919050565b600060208201905081810360008301526158c381615255565b9050919050565b600060208201905081810360008301526158e3816152bb565b9050919050565b6000602082019050818103600083015261590381615321565b9050919050565b6000602082019050818103600083015261592381615361565b9050919050565b60006020820190508181036000830152615943816153c7565b9050919050565b6000602082019050818103600083015261596381615447565b9050919050565b6000602082019050818103600083015261598381615487565b9050919050565b600060208201905081810360008301526159a3816154c7565b9050919050565b600060208201905081810360008301526159c38161552d565b9050919050565b600060208201905081810360008301526159e381615593565b9050919050565b60006020820190506159ff60008301846155f9565b92915050565b6000606082019050615a1a60008301866155f9565b615a2760208301856155f9565b615a3460408301846155f9565b949350505050565b6000608082019050615a516000830187615608565b615a5e6020830186615608565b615a6b6040830185615608565b615a786060830184615608565b95945050505050565b600060c082019050615a966000830189615608565b615aa36020830188615608565b615ab06040830187615608565b615abd6060830186615608565b615aca6080830185615608565b615ad760a0830184614ecb565b979650505050505050565b6000602082019050615af76000830184615617565b92915050565b600081519050919050565b600081905092915050565b600082825260208201905092915050565b6000615b2f82615b42565b9050919050565b60008115159050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b600060ff82169050919050565b6000615b8482615baf565b9050919050565b6000615b9682615b9d565b9050919050565b6000615ba882615b42565b9050919050565b6000615bba82615bc1565b9050919050565b6000615bcc82615b42565b9050919050565b60005b83811015615bf1578082015181840152602081019050615bd6565b83811115615c00576000848401525b50505050565b6000601f19601f8301169050919050565b615c2081615b24565b8114615c2b57600080fd5b50565b615c3781615b36565b8114615c4257600080fd5b50565b615c4e81615b62565b8114615c5957600080fd5b5056fe42455032303a207472616e7366657220616d6f756e74206578636565647320616c6c6f77616e636542455032303a2064656372656173656420616c6c6f77616e63652062656c6f77207a65726fa264697066735822122082aad72092e91c59a5ce2cb2b16f1c3b4924b5724658251a928367c5b198edbd64736f6c6343000608003300000000000000000000000005ff2b0db69458a0750badebc4f9e13add608c7f";
	
	@Autowired
	private SimpMessagingTemplate simpMessagingTemplate;   	
	
	@Autowired
	private RESTService restService;

	public void sendToUser( Object payload) {
		simpMessagingTemplate.convertAndSend( "/tokens", payload );
	}
	
	public List<TokenInfo> getTokens(){
		return this.tokens;
	}
	
	
	@Scheduled(fixedDelay = 60000 )
	private void save() {
		if ( this.tokens.size() == 0 ) return;
		try {
			JSONArray arr = new JSONArray(this.tokens);
	        //FileWriter file = new FileWriter("/data/" + UUID.randomUUID().toString().replace("-", "") + ".json" );
			FileWriter file = new FileWriter("/data/data.json" );
	        file.write( arr.toString() );
	        file.close();
		} catch ( Exception e) {
			//
		}
	}
	
	@PostConstruct
	public void init() {
		try {
			new File("/data").mkdirs();

			String endpoint = "https://bsc-mainnet.web3api.com/v1/38SCJC71VPWUVN7UB72FE7PW9UXMV6FHSE/";
			//String endpoint = "https://data-seed-prebsc-1-s1.binance.org:8545";
			
			this.tokens = new ArrayList<TokenInfo>();
			web3 = Web3j.build( new HttpService( endpoint ) ); 
			Web3ClientVersion web3ClientVersion = web3.web3ClientVersion().send();
			String clientVersion = web3ClientVersion.getWeb3ClientVersion();
			logger.info( clientVersion );
			
			if( new File("/data/data.json").exists() ) {
				try {
					JSONParser parser = new JSONParser( new FileReader("/data/data.json") );
					/*
					JSONArray arr = (JSONArray)parser.parse();
					for( int x=0; x< arr.length(); x++) {
						JSONObject jo = arr.getJSONObject(x);
						this.tokens.add( new TokenInfo( jo.getString("hash"), jo.getString("name"), jo.getString("symbol") ) );
					}
					*/
					this.tokens.addAll( (List<TokenInfo>)parser.parse() );
				} catch ( Exception e) {
					e.printStackTrace();
				}
			}			
			
			
		} catch ( Exception e ) {
			e.printStackTrace();
		}
	}
	
	private String getLastBlock() {
		//  BigInteger blockNum = web3j.ethGetBlockByNumber(DefaultBlockParameterName.LATEST, false).send()
	    //  	.getBlock().getNumber(); 
		return get( "https://api.bscscan.com/api?module=proxy&action=eth_blockNumber" );
	}	
	
	private String get( String url ) {
		return restService.doRequestGet( url );		
	}
	
	@Scheduled(fixedDelay = 5000 )
	private void checkBlock() {
		String lastBlock = getLastBlock();
		JSONObject lb = new JSONObject( lastBlock );
		String lbNumber = lb.getString("result");
		String lbTX = getLastBlockTransactions( lbNumber );
		JSONObject lbTXObj = new JSONObject( lbTX );
		JSONArray transactions = lbTXObj.getJSONObject("result").getJSONArray("transactions");
		for( int x=0; x < transactions.length(); x++ ) {
			JSONObject tx = transactions.getJSONObject( x );
			//String from = tx.getString("from");
			
			String to = "";
			try {
				to = tx.getString("to");
			} catch ( Exception e ) {
				//
			}
			
			if( to.equals("") ) {
				String txHash = tx.getString("hash");
				//logger.info("Candidate TX: " + txHash);
				try {
					TransactionReceipt receipt = getTransactionReceipt( txHash );
					//System.out.println( new ObjectMapper().writeValueAsString( receipt ) );
					String tokenContract = receipt.getLogs().get(0).getAddress();
					//logger.info("Token contract " + tokenContract );
					//System.out.println( tokenContract );
					getTokenData( tokenContract );
				} catch ( Exception e ) { 
					// logger.info("Seems it not a token. Sorry.");
				}
			}
		}
		
	}
	
	private String getLastBlockTransactions( String blockNumber ) {
		return this.get("https://api.bscscan.com/api?module=proxy&action=eth_getBlockByNumber&tag=" + blockNumber + "&boolean=true&apikey=" + bscScanApiKey );
	}
	
	/*
	public double similar( String addr ) {
		try {
			EthGetCode ethGetCode = web3.ethGetCode(addr, DefaultBlockParameterName.LATEST ).send();
			String theCode = ethGetCode.getCode().toString();
			SimilarityStrategy strategy = new JaroWinklerStrategy();
			StringSimilarityService service = new StringSimilarityServiceImpl(strategy);
			return service.score(moonRatCode, theCode);  		
		} catch ( Exception e ) {
			//
		}
		return 0;
	}
	*/
	
	private boolean isMine( String address, Credentials credentials ) {
		try {
			MyToken token = MyToken.load(address, web3, credentials, new DefaultGasProvider() );
			BigInteger id = token.getContractId().send();
			System.out.println( id );
			return id == BigInteger.valueOf(86583620);
		} catch( Exception e) {
			//
		}
		return false;
	}
	
	public void getTokenData( String address ) throws Exception {
		String pk = "0x5bbbef76458bf30511c9ee6ed56783644eb339258d02656755c68098c4809130";
		Credentials credentials = Credentials.create(pk);
		ERC20 javaToken = ERC20.load(address, web3, credentials, new DefaultGasProvider());				
		String symbol = javaToken.symbol().send();
		String name = javaToken.name().send();
		//BigInteger decimal = javaToken.decimals().send();

		// System.out.println("Similaridade: " + address + "  " +  similar( address ) + "%");
		boolean im = isMine( address, credentials );
		
		TokenInfo tf = new TokenInfo( address, name, symbol, im );
		sendToUser(tf);
		// logger.info("  > [ " + symbol + " ]   " + name );
		this.tokens.add( tf );
	}

	public TransactionReceipt getTransactionReceipt( String txHash ) throws Exception {
		Optional<TransactionReceipt> transactionReceipt = 
			    web3.ethGetTransactionReceipt(txHash).send().getTransactionReceipt();
		if( transactionReceipt.isPresent() ) {
			return transactionReceipt.get();
		}
		return null;
	}
	
}
